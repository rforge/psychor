<html><head><title>Active Set Methods for Isotone Optimization</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>activeSet(isotone)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   activeSet">
<param name="keyword" value="R:   print.activeset">
<param name="keyword" value="R:   aSolver">
<param name="keyword" value="R:   dSolver">
<param name="keyword" value="R:   eSolver">
<param name="keyword" value="R:   fSolver">
<param name="keyword" value="R:   hSolver">
<param name="keyword" value="R:   iSolver">
<param name="keyword" value="R:   lfSolver">
<param name="keyword" value="R:   lsSolver">
<param name="keyword" value="R:   mSolver">
<param name="keyword" value="R:   oSolver">
<param name="keyword" value="R:   pSolver">
<param name="keyword" value="R:   sSolver">
<param name="keyword" value=" Active Set Methods for Isotone Optimization">
</object>


<h2>Active Set Methods for Isotone Optimization</h2>


<h3>Description</h3>

<p>
Isotone optimization can be formulated as a convex programming problem with simple linear constraints.
This functions offers active set strategies for a collection of isotone optimization problems pre-specified in the 
package.
</p>


<h3>Usage</h3>

<pre>
activeSet(x, isomat, mySolver = lsSolver, ups = 1e-12, check = FALSE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
Vector containing predictors</td></tr>
<tr valign="top"><td><code>isomat</code></td>
<td>
Matrix with 2 columns that contains isotonicity conditions (see examples)</td></tr>
<tr valign="top"><td><code>mySolver</code></td>
<td>
Various functions are pre-defined (see details). For user-specified functions <code>fSolver</code> with additional 
arguments can be used (see details as well).</td></tr>
<tr valign="top"><td><code>ups</code></td>
<td>
Upper boundary</td></tr>
<tr valign="top"><td><code>check</code></td>
<td>
If TRUE, feasibility checks of the solution are performed</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Additional arguments for <code>fSolver</code> (see details)</td></tr>
</table>

<h3>Details</h3>

<p>
The following solvers are specified: <code>aSolver()</code> for asymmetric least squares, <code>dSolver()</code> for the least 
absolute value, <code>eSolver()</code> minimizes l1-approximation, <code>fSolver()</code> for arbitrary differentiable functions (additional
arguments <code>fobj</code> and <code>gobj</code> must be provided; see examples), <code>hSolver()</code> for Huber loss function, <code>iSolver()</code> for 
SILF loss (support vector regression), <code>lfSolver()</code> for least squares with non-diagonal weights, <code>lsSolver()</code> for least 
squares with diagonal weights (with response values <code>z</code> and weights <code>w</code> as additional arguments) , <code>mSolver()</code> for Chebyshev norm, <code>oSolver()</code> for power norm, <code>pSolver()</code> for quantile 
loss function, and finally <code>sSolver()</code> for Poisson likelihood. 
</p>
<p>
More descriptions can be found in the package vignette.
</p>


<h3>Value</h3>

<p>
Generates an object of class <code>activeset</code>.
</p>
<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
Solution</td></tr>
<tr valign="top"><td><code>lbd</code></td>
<td>
</td></tr>
<tr valign="top"><td><code>fval</code></td>
<td>
Value of the target function</td></tr>
<tr valign="top"><td><code>ay</code></td>
<td>
</td></tr>
<tr valign="top"><td><code>hl</code></td>
<td>
</td></tr>
<tr valign="top"><td><code>gradient</code></td>
<td>
Gradient vector</td></tr>
<tr valign="top"><td><code>isocheck</code></td>
<td>
List containing <code>ckFeasibility</code> , <code>ckLagrange</code> , <code>ckCompSlack</code> , <code>ckGrad</code> if feasibility 
checks were performed.</td></tr>
<tr valign="top"><td><code>call</code></td>
<td>
Matched call</td></tr>
</table>

<h3>Author(s)</h3>

<p>
Jan de Leeuw, Kurt Hornik, Patrick Mair
</p>


<h3>References</h3>

<p>
de Leeuw, J., Hornik, K., Mair, P. (2008). Isotone optimization in R: Active Set methods and pool-adjacent-violators algorithm. 
Journal of Statistical Software, forthcoming.
</p>


<h3>Examples</h3>

<pre>

##Example 1: Comparison with PAVA
set.seed(12345)
x0 &lt;- 9:1                   ##predictor values
z &lt;- rnorm(9)               ##response values
wu &lt;- rep(1,9)              ##unit weights
btota &lt;- cbind(1:8, 2:9)    ##Matrix defining isotonicity (total order)

##Now we apply PAVA, LS active set, and, again LS active set by specifying function (fobj) and derivative (gobj)          
fit.pava &lt;- gpava(x0, z)
fit.ls &lt;- activeSet(x0, btota, lsSolver, w = wu, z = z)
fit.f &lt;- activeSet(x0, btota, fSolver, fobj = function(x) sum(wu*(x-z)^2), gobj = function(x) 2*drop(wu*(x-z)))

##Matrix with fitted values (basically same results for each method)
val.mat &lt;- cbind(fit.pava$yfit, fit.ls$x, fit.f$x)
val.mat

##Example 2: Diagonal vs. non-diagonal weights
set.seed(12345)
ww &lt;- 1:9                                  ##weight vector
wf &lt;- crossprod(matrix(rnorm(81),9,9))/9   ##symmetric weight matrix 

activeSet(x0, btota, lsSolver, check = TRUE, w = ww, z = z)

#FIXME!!! activeSet(x0, btota, lfSolver, check = TRUE, x0, w = wf, z = z) 

##Example 3: Other norms
##Approximate l1 with additional argument eps = 1e-4
activeSet(x0, btota, eSolver, check = TRUE, z = z, w = wu, eps = 1e-4)

##Approximate l1 with additional power argument p = 1.2
activeSet(x0, btota, oSolver, check = TRUE, z = z, w = wu, p = 1.2)

##Least absolute values (exact l1)
activeSet(x0, btota, dSolver, check = TRUE, w = wu, z = z)

##Approximate l(infty) with additional power argument p = 7
#FIXME!!! activeSet(x0, btota, oSolver, check = TRUE, z = z, w = wu, p = 7)

##Exact l(infty) (Chebyshew norm)
activeSet(x0, btota, mSolver, check = TRUE, w = wu, z = z)

##Poisson likelihood
set.seed(12345)    
z &lt;- rpois(9, 5)
activeSet(x0, btota, sSolver, check = TRUE, w = wu, z = z)

##Asymmetric least squares with additional asymmetric weights aw and bw
activeSet(x0, btota, aSolver, check = TRUE, z=z, w = wu, aw = 2, bw = 1)

##Huber norm with additional argument eps = 1
activeSet(x0, btota , hSolver, check = TRUE, z = z, w = wu, eps = 1)

##SILF norm with additional arguments beta = 0.8 and eps = 0.2
activeSet(x0, btota, iSolver, check = TRUE, z = z, w = wu, beta = 0.8, eps = 0.2)

##Example 4: Other orders
## Tree order
btree &lt;- matrix(c(1,1,2,2,2,3,3,8,2,3,4,5,6,7,8,9),8,2)
activeSet(x0, btree, lsSolver, check = TRUE, w = wu, z = z)

## Block order 
#bprim &lt;- cbind(c(rep(1,3),rep(2,3),rep(3,3),rep(4,3),rep(5,3),rep(6,3)),
#             c(rep(c(4,5,6),3),rep(c(7,8,9),3)))
#activeSet(x0, bprim, lsSolver, check = TRUE, w = wu, z = z)

## Loop order
#bloop &lt;- matrix(c(1,2,3,3,4,5,6,6,7,8,3,3,4,5,6,6,7,8,9,9),10,2)
#activeSet(x0, bloop, lsSolver, check = TRUE, w = wu, z = z)

</pre>



<hr><div align="center">[Package <em>isotone</em> version 0.1-0 <a href="00Index.html">Index]</a></div>

</body></html>
